name: Code Quality Betterer

on: [push]

env:
  FORCE_COLOR: '1'
  CHATOPS_RESULTS_FILE_UPDATE_COMMAND: "betterer:update"
  BETTERER_CONFIG_FILE_PATH: ".betterer"
  BETTERER_RESULTS_FILE_PATH: ".betterer.results"

jobs:
  code-quality-check:
    runs-on: ubuntu-18.04
    steps:
      - uses: actions/checkout@v2
      - name: Use Node.js
        uses: actions/setup-node@v1
        with:
          node-version: 16.3
      - name: Install dependencies
        run: yarn --frozen-lockfile --non-interactive --no-progress
      - name: Incremental code quality check
        uses: Evilweed/betterer-github-action@v1.0.0
        with:
          chatops_results_file_update_command: "betterer:update"
          betterer_results_file_name: ".betterer.results"
          args: --config /github/workspace/.betterer --results /github/workspace/.betterer.results --reporter /build/custom-simple-reporter.js

